(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-572861c8"],{"41fb":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"customer_details"},[s("header",{staticClass:"mui-bar mui-bar-nav"},[s("router-link",{staticClass:"mui-icon mui-icon-left-nav mui-pull-left",attrs:{to:{name:"customer_statistics"}}}),s("h1",{staticClass:"mui-title"},[t._v("客户详情")]),s("router-link",{staticClass:"mui-icon mui-icon mui-icon-home mui-pull-right",attrs:{to:{name:"index"}}})],1),s("login-loading",{directives:[{name:"show",rawName:"v-show",value:t.imgUrl_loading,expression:"imgUrl_loading"}]}),t._m(0),s("div",{staticClass:"mui-content app"},[s("form",{staticClass:"mui-input-group"},[s("ul",{staticClass:"mui-table-view"},[s("li",{staticClass:"mui-table-view-cell mui-collapse"},[s("a",{staticClass:"mui-navigate-right left-mar",attrs:{href:"#"}},[s("div",{staticClass:"mui-input-row"},[s("label",[t._v("项目名称")]),s("div",[t._v(t._s(t.customer_name))])])]),s("div",{staticClass:"mui-collapse-content"},[s("div",{staticClass:"mui-input-row"},[s("label",[t._v("项目名称")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.customer_name,expression:"customer_name"}],staticClass:"mui-input-clear",attrs:{type:"text",placeholder:"无"},domProps:{value:t.customer_name},on:{input:function(e){e.target.composing||(t.customer_name=e.target.value)}}})]),s("div",{staticClass:"mui-input-row"},[s("label",[t._v("联系人")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.customer_linkman,expression:"customer_linkman"}],staticClass:"mui-input-clear",attrs:{type:"text",placeholder:"无"},domProps:{value:t.customer_linkman},on:{input:function(e){e.target.composing||(t.customer_linkman=e.target.value)}}})]),s("div",{staticClass:"mui-input-row"},[s("label",[t._v("联系方式")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.customer_connect,expression:"customer_connect"}],staticClass:"mui-input-clear",attrs:{type:"text",placeholder:"无"},domProps:{value:t.customer_connect},on:{input:function(e){e.target.composing||(t.customer_connect=e.target.value)}}})]),s("div",{staticClass:"mui-input-row"},[s("label",[t._v("设计师")]),s("select",{directives:[{name:"model",rawName:"v-model",value:t.customer_stylist,expression:"customer_stylist"}],attrs:{name:""},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.customer_stylist=e.target.multiple?s:s[0]}}},[s("option",{attrs:{value:""}},[t._v("请选择")]),t._l(t.listName,function(e){return s("option",{domProps:{value:e.fund_person_id}},[t._v(t._s(e.fund_person))])})],2)]),s("div",{staticClass:"mui-input-row"},[s("label",[t._v("装修面积")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.customer_Decorate,expression:"customer_Decorate"}],staticClass:"mui-input-clear",attrs:{type:"text",placeholder:"无"},domProps:{value:t.customer_Decorate},on:{input:function(e){e.target.composing||(t.customer_Decorate=e.target.value)}}})]),s("div",{staticClass:"mui-input-row"},[s("label",[t._v("推荐人")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.customer_referrer,expression:"customer_referrer"}],staticClass:"mui-input-clear",attrs:{type:"text",placeholder:"无"},domProps:{value:t.customer_referrer},on:{input:function(e){e.target.composing||(t.customer_referrer=e.target.value)}}})]),s("div",{staticClass:"mui-input-row"},[s("label",[t._v("项目预算")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.customer_budget,expression:"customer_budget"}],staticClass:"mui-input-clear",attrs:{type:"text",placeholder:"无"},domProps:{value:t.customer_budget},on:{input:function(e){e.target.composing||(t.customer_budget=e.target.value)}}})]),s("div",{staticClass:"mui-input-row"},[s("label",[t._v("客户等级")]),s("select",{directives:[{name:"model",rawName:"v-model",value:t.Customer_grade,expression:"Customer_grade"}],class:{classGray:""==t.Customer_grade,classBlack:""!=t.Customer_grade},attrs:{name:""},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.Customer_grade=e.target.multiple?s:s[0]}}},[s("option",{attrs:{value:""}},[t._v("请选择")]),t._l(t.listLevel,function(e){return s("option",{domProps:{value:e.text}},[t._v(t._s(e.text))])})],2)]),s("div",{staticClass:"row-left"},[s("div",{staticClass:"row-left-on"},[s("label",[t._v("所属类型")]),s("select",{directives:[{name:"model",rawName:"v-model",value:t.Customer_type,expression:"Customer_type"}],class:{classGray:""==t.Customer_type,classBlack:""!=t.Customer_type},attrs:{name:""},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.Customer_type=e.target.multiple?s:s[0]}}},[s("option",{attrs:{value:""}},[t._v("请选择")]),t._l(t.list_type,function(e){return s("option",{domProps:{value:e.text}},[t._v(t._s(e.text))])})],2)]),s("div",{staticClass:"radio-left"},t._l(t.listRadio,function(e){return s("div",{staticClass:"mui-input-row mui-radio mui-left"},[s("label",[t._v(t._s(e.text))]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.listRadio_all,expression:"listRadio_all"}],attrs:{name:"radio1",type:"radio"},domProps:{value:e.text,checked:t._q(t.listRadio_all,e.text)},on:{change:function(s){t.listRadio_all=e.text}}})])}),0)]),s("div",{staticClass:"mui-input-row all-row textreap"},[s("label",[t._v("客户需求")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.customer_demand,expression:"customer_demand"}],attrs:{type:"text"},domProps:{value:t.customer_demand},on:{input:function(e){e.target.composing||(t.customer_demand=e.target.value)}}})]),s("div",{staticClass:"mui-input-row update-btn"},[s("div",[s("button",{staticClass:"mui-btn mui-btn-black",attrs:{type:"button"},on:{click:t.UpdateCustomer}},[t._v("信息修改")])])])])])])]),s("form",{staticClass:"mui-input-group form-pad box-h4"},[s("div",{staticClass:"box3 "},[t._m(1),s("div",{staticClass:"mui-input-row go-nai"},[s("label",[t._v("跟进人员")]),s("select",{directives:[{name:"model",rawName:"v-model",value:t.follow_person,expression:"follow_person"}],class:{classGray:""==t.follow_person,classBlack:""!=t.follow_person},attrs:{name:""},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.follow_person=e.target.multiple?s:s[0]}}},[s("option",{attrs:{value:"",selected:"selected"}},[t._v("请选择")]),t._l(t.profetName,function(e){return s("option",{domProps:{value:e.fund_person_id}},[t._v(t._s(e.fund_person))])})],2)]),s("div",{staticClass:"mui-input-row go-nai"},[s("label",[t._v("下次跟进")]),s("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},on:{focus:t.forbid},model:{value:t.nexDate,callback:function(e){t.nexDate=e},expression:"nexDate"}})],1),s("div",{staticClass:"mui-input-row go-nai"},[s("label",[t._v("当前阶段")]),s("select",{directives:[{name:"model",rawName:"v-model",value:t.stage_name,expression:"stage_name"}],class:{classGray:""==t.stage_name,classBlack:""!=t.stage_name},attrs:{name:""},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.stage_name=e.target.multiple?s:s[0]}}},[s("option",{attrs:{value:""}},[t._v("请选择")]),t._l(t.vstage_name,function(e){return s("option",[t._v(t._s(e.stage_name))])})],2)])]),s("div",{staticClass:"box"},[s("div",{staticClass:"row-go"},[s("div",{staticClass:"mui-input-row row-textarea"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.list_text,expression:"list_text"}],attrs:{name:"",rows:"",cols:"",placeholder:"请输入跟进记录"},domProps:{value:t.list_text},on:{input:function(e){e.target.composing||(t.list_text=e.target.value)}}})]),s("div",{staticClass:"mui-input-row update-img"},[s("label",[t._v("文件上传")]),s("el-upload",{attrs:{action:"https://formattingclub.com/YiNuoLogin/AfterSale/uploadImg","list-type":"picture-card","on-preview":t.handlePictureCardPreview,"on-success":t.handleAvatarSuccess,"on-remove":t.handleRemove}},[s("i",{staticClass:"el-icon-plus"})]),s("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[s("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1),s("div",{staticClass:"go-add"},[s("button",{attrs:{type:"button"},on:{click:t.add}},[t._v("保存记录")])])])])]),s("form",{staticClass:"mui-input-group form-pad box-h4"},[s("h4",[t._v("跟进记录")]),t._l(t.stage,function(e,i){return s("div",{key:i,staticClass:"box"},[s("div",{staticClass:"mui-input-row jin"},[s("div",{staticClass:"jin-date"},[s("p",[t._v(t._s(t._f("data")(e.follow_date)))])]),s("div",{staticClass:"gen"},[t._v("\n                "+t._s(e.fund_person)+"\n              ")]),s("div",{staticClass:"gen"},[t._v("\n                "+t._s(e.follow_stage)+"\n              ")])]),s("div",{staticClass:"row-go"},[s("div",{staticClass:"mui-input-row row-textarea"},[s("div",{staticClass:"text-follow"},[t._v(t._s(e.follow_text))]),s("div",{staticClass:"commint-text"},t._l(t.searchInput,function(i,a){return e.follow_id==i.comment_follow_id?s("div",{on:{click:function(s){return s.stopPropagation(),t.fund_person_idClick(e.follow_id,e.fund_person,i.user_number_name)}}},[t._v("\n                  "+t._s(i.user_number_name)+"："+t._s(i.comment_text)+"\n                ")]):t._e()}),0),t._l(t.listInput,function(a){return s("div",{directives:[{name:"show",rawName:"v-show",value:t.commitOn,expression:"commitOn"}],staticClass:"input-commit"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.inputTxt[i],expression:"inputTxt[index]"}],attrs:{placeholder:"请输入评论"},domProps:{value:t.inputTxt[i]},on:{click:function(s){return t.fllow_idClick(e.follow_id)},input:function(e){e.target.composing||t.$set(t.inputTxt,i,e.target.value)}}}),s("button",{staticClass:"mui-btn mui-btn-black commit-button",attrs:{type:"button"},on:{click:function(e){return t.comment(i)}}},[t._v("评论")])])}),s("div",{staticClass:"div-img"},[s("img",{directives:[{name:"show",rawName:"v-show",value:e.imgsrc,expression:"item.imgsrc"}],attrs:{src:t.getImgUrl(e.imgsrc),alt:"lodingImg"}})])],2)])])})],2),s("div",{staticClass:"form-botton"},[s("button",{staticClass:"mui-btn mui-btn-black",attrs:{type:"button"},on:{click:t.goadd}},[t._v("开工")]),s("button",{staticClass:"mui-btn mui-btn-black",attrs:{type:"button"},on:{click:t.dele}},[t._v("删除")])])]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.inputText,expression:"inputText"}],staticClass:"input-text",attrs:{id:"myinput"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.sendInput,expression:"sendInput"}],ref:"box",attrs:{type:"text",autofocus:"",id:"input",placeholder:t.textInput},domProps:{value:t.sendInput},on:{input:function(e){e.target.composing||(t.sendInput=e.target.value)}}}),s("div",[s("button",{attrs:{type:"button"},on:{click:t.sends}},[t._v("发送")])])])],1)},a=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mui-content"},[s("div",{staticClass:"customer"},[s("h2",[t._v("客户详细")]),s("p",[t._v("/Client follow-up")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("h4",[t._v("添加记录")])])}],o={name:"customer_details",inject:["reload"],data(){return{imgUrl_loading:!1,projet:"",customer_name:"",customer_linkman:"",customer_connect:"",customer_stylist:"",customer_Decorate:"",Customer_type:"",customer_referrer:"",customer_budget:"",customer_demand:"",listtime:"",stage:"",stage_name:"",listRadio_all:"",follow_text:"",listName:"",follow_person:"",nexDate:"",profetName:"",Customer_grade:"",listInput:[{text:""}],dialogImageUrl:"",dialogVisible:!1,ImgBase:"",textInput:"评论",list_text:"",vstage_name:[{stage_name:"未量尺"},{stage_name:"平面图"},{stage_name:"效果图"},{stage_name:"施工图"}],listLevel:[{text:"A"},{text:"B"},{text:"C"}],list_type:[{text:"餐饮"},{text:"服装"},{text:"办公"},{text:"健身"},{text:"美容"},{text:"娱乐"},{text:"教育"},{text:"医疗"},{text:"销售"},{text:"小区"}],listRadio:[{text:"家装"},{text:"工装"}],cv:"",commitOn:!0,inputText:!1,sendInput:"",fllow_id:"",inputTxt:[],Select_Comment:"",searchInput:"",names:"",fund_person_id_user:"",lengMax:{textAlign:"right",padding:"7px 16px",color:"#767676"}}},created(){this.cv=JSON.parse(localStorage.customer_statistics),this.customer_name=this.cv.customer_name,this.customer_linkman=this.cv.customer_linkman,this.customer_connect=this.cv.customer_connect,this.customer_stylist=this.cv.fund_person_id,this.customer_Decorate=this.cv.customer_Decorate,this.customer_referrer=this.cv.customer_referrer,this.customer_budget=this.cv.customer_budget,this.Customer_type=this.cv.customer_type,this.customer_demand=this.cv.customer_demand,this.Customer_grade=this.cv.customer_grade,""==this.cv.customer_form?this.listRadio_all="":"家装"==this.cv.customer_form?this.listRadio_all="家装":"工装"==this.cv.customer_form&&(this.listRadio_all="工装"),this.imgsrc=this.cv.imgsrc,this.axios.get("/select_follow_person?fund_person_state=4").then(t=>{this.profetName=t.data.data}),this.axios.get("/Customer/SelectFollow?Customer_id="+this.cv.customer_id).then(t=>{this.stage=t.data,"0"==t.data.length&&(this.commitOn=!1)});var t=this;this.axios.get("/Customer/Select_Comment").then(e=>{var s=[];for(var i in this.Select_Comment=e.data.data,t.Select_Comment)for(var a in t.stage)t.Select_Comment[i].comment_follow_id==t.stage[a].follow_id&&s.push(t.Select_Comment[i]);this.searchInput=s}),this.axios.get("/select_follow_person?fund_person_state=3").then(t=>{for(var e in this.listName=t.data.data,this.listName)this.listName[e].fund_person_id==this.cv.fund_person_id&&(this.fund_person_id_user=this.listName[e].user_id)}),this.reply()},methods:{reply(){var t=this;document.addEventListener("click",e=>{t.$refs.box.contains(e.target)||(t.inputText=!1,t.sendInput="",t.textInput="评论")})},forbid(){document.activeElement.blur()},handleRemove(t,e){console.log(t,e)},handlePictureCardPreview(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},handleAvatarSuccess(t,e){this.ImgBase=t,console.log(t)},getImgUrl(t){if(void 0!=t){var e="https://formattingclub.com/static/YiNuo/"+t;return e}},fllow_idClick(t){this.fllow_id=t},fund_person_idClick(t,e,s){this.fllow_id=t,this.textInput="回复："+s,this.names=s,this.inputText=!0,document.getElementById("input").focus()},sends(){if(""==this.sendInput)return mui.toast("回复不能为空"),!1,!1;var t="?comment_follow_id="+this.fllow_id+"&comment_text=回复"+this.names+this.sendInput+"&comment_user_id="+sessionStorage.getItem("loginUserId")+"&comment_to_user_id="+this.fund_person_id_user+"&information_type=2";this.axios.post("/Customer/Insert_Comment"+t).then(t=>{200===t.status&&(this.inputText=!1,this.textInput="",this.reload(),"添加成功"==t.data.data&&mui.toast("发送成功"))})},comment(t){var e="";for(var t in this.inputTxt)e+=this.inputTxt[t];if(""==e)return mui.toast("评论不能为空"),!1,!1;var s="?comment_follow_id="+this.fllow_id+"&comment_text="+e+"&comment_user_id="+sessionStorage.getItem("loginUserId")+"&comment_to_user_id="+this.fund_person_id_user+"&information_type=1";this.axios.post("/Customer/Insert_Comment"+s).then(t=>{200===t.status&&(this.inputText=!1,this.inputTxt="",this.reload(),"添加成功"==t.data.data&&mui.toast("发送成功"))})},add(){if(""==this.follow_person)return mui.toast("跟进人不能为空"),!1,!1;if(""==this.nexDate)return mui.toast("下次跟进不能为空"),!1,!1;if(""==this.stage_name)return mui.toast("当前阶段不能为空"),!1,!1;if(""==this.list_text)return mui.toast("跟进记录不能为空"),!1,!1;var t=new Date(this.nexDate),e=t.getFullYear(),s=t.getMonth()+1,i=t.getDate(),a=`${e}-${s}-${i}`;this.imgUrl_loading=!0;var o="?Customer_name="+this.cv.customer_id+"&follow_person="+this.follow_person+"&follow_text="+this.list_text+"&follow_stage="+this.stage_name+"&follow_Pre_date="+a+"&imgsrc="+this.ImgBase;this.axios.get("/Customer/AddFollow"+o).then(t=>{200===t.status&&(this.imgUrl_loading=!1,"添加成功"==t.data.data&&mui.toast("发送成功"))})},goadd(){var t=this;if(""==this.radio)return mui.toast("阶段不能为空"),!1,!1;this.imgUrl_loading=!0,this.axios.get("/Customer/Update_Customer?Customer_id="+this.cv.customer_id+"&Customer_name_state=2").then(e=>{200===e.status&&(this.imgUrl_loading=!1,"修改成功"==e.data.data&&mui.alert("已开工",function(){t.$router.push({name:"customer_statistics"})}))}),this.alerto=!1},UpdateCustomer(){var t=this,e="?Customer_id="+this.cv.customer_id;this.customer_name!=this.cv.customer_name&&(e+="&Customer_name="+this.customer_name),this.customer_linkman!=this.cv.customer_linkman&&(e+="&Customer_linkman="+this.customer_linkman),this.customer_connect!=this.cv.customer_connect&&(e+="&Customer_connect="+this.customer_connect),this.customer_stylist!=this.cv.customer_stylist&&(e+="&Customer_stylist="+this.customer_stylist),this.customer_Decorate!=this.cv.customer_Decorate&&(e+="&Customer_Decorate="+this.customer_Decorate),this.customer_budget!=this.cv.customer_budget&&(e+="&Customer_budget="+this.customer_budget),this.customer_demand!=this.cv.customer_demand&&(e+="&Customer_demand="+this.customer_demand),this.Customer_type!=this.cv.customer_type&&(e+="&Customer_type="+this.Customer_type),this.listRadio_all!=this.cv.customer_form&&(e+="&Customer_form="+this.listRadio_all),this.customer_referrer!=this.cv.customer_referrer&&(e+="&Customer_referere="+this.customer_referrer),this.Customer_grade!=this.cv.Customer_grade&&(e+="&Customer_grade="+this.Customer_grade),this.axios.get("/Customer/UpdateCustomer"+e).then(e=>{this.customer_name!=this.cv.customer_name||this.customer_linkman!=this.cv.customer_linkman||this.customer_connect!=this.cv.customer_connect||this.customer_stylist!=this.cv.customer_stylist||this.customer_Decorate!=this.cv.customer_Decorate||this.customer_referrer!=this.cv.customer_referrer||this.customer_budget!=this.cv.customer_budget||this.Customer_type!=this.cv.Customer_type?mui.alert(e.data,function(){t.$router.push({name:"customer_statistics"})}):mui.toast("您什么都未修改")})},dele(){var t=this;this.imgUrl_loading=!0,this.axios.get("/Customer/DeleteCustomer?Customer="+this.cv.customer_id).then(e=>{200===e.status&&(this.imgUrl_loading=!1,"删除成功"==e.data?mui.alert("删除成功",function(){t.$router.push({path:"customer_statistics"})}):alert("删除失败"))})}}},r=o,n=(s("6d9a"),s("2877")),l=Object(n["a"])(r,i,a,!1,null,"7cfa6e89",null);e["default"]=l.exports},"6d9a":function(t,e,s){"use strict";var i=s("ec2b"),a=s.n(i);a.a},ec2b:function(t,e,s){}}]);